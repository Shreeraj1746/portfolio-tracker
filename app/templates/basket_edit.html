{% extends "base.html" %}

{% block content %}
<section class="panel">
  <h1>Edit Basket: {{ basket.name }}</h1>

  <form method="post" action="/baskets/{{ basket.id }}/edit" class="form-grid">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />

    <label class="full-width">
      Basket name
      <input type="text" name="name" value="{{ basket.name }}" required />
    </label>

    <div class="checkbox-list full-width">
      <strong>Members</strong>
      <p class="muted">Share ratios are derived automatically from current holdings.</p>
      {% for asset in assets %}
        {% set checked = asset.id in selected_ids %}
        <label class="asset-pick">
          <span>
            <input type="checkbox" name="asset_ids" value="{{ asset.id }}" {% if checked %}checked{% endif %} />
            {{ asset.symbol }} <span class="muted">{{ asset.name }}</span>
          </span>
          <span class="muted">{{ asset_quantities.get(asset.id, 0)|number(6) }} shares</span>
        </label>
      {% else %}
        <p class="muted">No active market assets available.</p>
      {% endfor %}
    </div>

    <div class="actions-row full-width">
      <button type="submit">Save Basket</button>
      <a href="/baskets/{{ basket.id }}">Cancel</a>
    </div>
  </form>

  <div class="divider"></div>

  <form method="post" action="/baskets/{{ basket.id }}/delete" onsubmit="return confirm('Delete this basket?');">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
    <button type="submit" class="button-danger">Delete Basket</button>
  </form>
</section>
{% endblock %}
